# í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì ì§€ì‹œì„œ
- ì‘ì„±ì¼: 2025-11-05
- ì„¤ê³„ì: ì•„í‚¤í…ì²˜ ì„¤ê³„ì
- ëŒ€ìƒ: í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì
- ê¸°ìˆ  ìŠ¤íƒ: HTML/CSS/JavaScript (ES6+)
- ìƒíƒœ: ìŠ¹ì¸
- ë²„ì „: 1.0

## 1. í”„ë¡œì íŠ¸ ê°œìš”

íŠ¸ë¦¬ êµ¬ì¡° ê¸°ë°˜ AI ëŒ€í™” ì‹œìŠ¤í…œì˜ í”„ë¡ íŠ¸ì—”ë“œë¥¼ ê°œë°œí•©ë‹ˆë‹¤. ì‚¬ìš©ìëŠ” ëŒ€í™” ë…¸ë“œë¥¼ í´ë¦­í•˜ì—¬ ê²½ë¡œë¥¼ ì „í™˜í•˜ê³ , ì²´í¬í¬ì¸íŠ¸ë¡œ ë³µì›í•˜ë©°, íŠ¸ë¦¬ êµ¬ì¡°ë¥¼ ì‹œê°ì ìœ¼ë¡œ íƒìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### í•µì‹¬ ê¸°ëŠ¥
- íŠ¸ë¦¬ êµ¬ì¡° ì‹œê°í™” (TreeView)
- ëŒ€í™” íŒ¨ë„ (ChatView)
- ê²½ë¡œ í‘œì‹œ (Breadcrumbs)
- ì²´í¬í¬ì¸íŠ¸ ëª©ë¡ ë° ë³µì› (CheckpointList)
- ì „ì—­ ìƒíƒœ ê´€ë¦¬ (StateManager)

### ê¸°ìˆ  ì œì•½
- **í”„ë ˆì„ì›Œí¬ ì—†ìŒ**: Vanilla JavaScriptë§Œ ì‚¬ìš©
- **íŒŒì¼ í¬ê¸°**: ê° íŒŒì¼ ìµœëŒ€ 1,000ì¤„, ì´ìƒì  200ì¤„
- **ES6+**: ìµœì‹  JavaScript ë¬¸ë²• ì‚¬ìš©
- **ëª¨ë“ˆ ì‹œìŠ¤í…œ**: ES6 import/export

## 2. íŒŒì¼ êµ¬ì¡°

```
frontend/
â”œâ”€â”€ index.html              # ë©”ì¸ í˜ì´ì§€
â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ reset.css           # CSS ë¦¬ì…‹
â”‚   â”œâ”€â”€ layout.css          # ë ˆì´ì•„ì›ƒ ìŠ¤íƒ€ì¼
â”‚   â”œâ”€â”€ tree-view.css       # TreeView ìŠ¤íƒ€ì¼
â”‚   â”œâ”€â”€ chat-view.css       # ChatView ìŠ¤íƒ€ì¼
â”‚   â””â”€â”€ components.css      # ê³µí†µ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ main.js             # ì§„ì…ì  (200ì¤„)
â”‚   â”œâ”€â”€ state/
â”‚   â”‚   â””â”€â”€ StateManager.js # ì „ì—­ ìƒíƒœ ê´€ë¦¬ (300ì¤„)
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ TreeView.js     # íŠ¸ë¦¬ ë·° (400ì¤„)
â”‚   â”‚   â”œâ”€â”€ ChatView.js     # ëŒ€í™” íŒ¨ë„ (300ì¤„)
â”‚   â”‚   â”œâ”€â”€ Breadcrumbs.js  # ê²½ë¡œ í‘œì‹œ (150ì¤„)
â”‚   â”‚   â””â”€â”€ CheckpointList.js # ì²´í¬í¬ì¸íŠ¸ (250ì¤„)
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ ApiService.js   # API í˜¸ì¶œ (400ì¤„)
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ dom.js          # DOM ìœ í‹¸ (150ì¤„)
â”‚       â””â”€â”€ validators.js   # ê²€ì¦ (100ì¤„)
â””â”€â”€ assets/
    â””â”€â”€ icons/              # ì•„ì´ì½˜ íŒŒì¼
```

## 3. íŒŒì¼ë³„ êµ¬í˜„ ê°€ì´ë“œ

### 3.1 index.html

#### ëª©ì 
ë©”ì¸ HTML í˜ì´ì§€, ë ˆì´ì•„ì›ƒ ì •ì˜

#### êµ¬ì¡°
```html
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ê³ ë¯¼ìƒë‹´ - íŠ¸ë¦¬ ëŒ€í™” ì‹œìŠ¤í…œ</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/tree-view.css">
    <link rel="stylesheet" href="css/chat-view.css">
    <link rel="stylesheet" href="css/components.css">
</head>
<body>
    <div class="app-container">
        <!-- í—¤ë” -->
        <header class="app-header">
            <h1>AI ê³ ë¯¼ìƒë‹´</h1>
            <div class="header-controls">
                <button id="new-conversation-btn">ìƒˆ ëŒ€í™”</button>
                <button id="save-checkpoint-btn">ì²´í¬í¬ì¸íŠ¸ ì €ì¥</button>
            </div>
        </header>

        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <main class="app-main">
            <!-- ì¢Œì¸¡: íŠ¸ë¦¬ ë·° -->
            <aside class="sidebar sidebar-left">
                <h2>ëŒ€í™” íŠ¸ë¦¬</h2>
                <div id="tree-view-container"></div>
            </aside>

            <!-- ì¤‘ì•™: ëŒ€í™” íŒ¨ë„ -->
            <section class="main-content">
                <div id="breadcrumbs-container"></div>
                <div id="chat-view-container"></div>
            </section>

            <!-- ìš°ì¸¡: ì²´í¬í¬ì¸íŠ¸ ëª©ë¡ -->
            <aside class="sidebar sidebar-right">
                <h2>ì²´í¬í¬ì¸íŠ¸</h2>
                <div id="checkpoint-list-container"></div>
            </aside>
        </main>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>
```

#### ìš”êµ¬ì‚¬í•­
- ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ (ìµœì†Œ ë„ˆë¹„: 1024px)
- 3ë‹¨ êµ¬ì¡° (íŠ¸ë¦¬ ë·° / ëŒ€í™” íŒ¨ë„ / ì²´í¬í¬ì¸íŠ¸)
- ì‹œë§¨í‹± HTML ì‚¬ìš©

---

### 3.2 js/main.js (ì§„ì…ì )

#### ëª©ì 
ì•± ì´ˆê¸°í™”, ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸, ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡

#### í¬ê¸° ì œí•œ
ìµœëŒ€ 200ì¤„

#### êµ¬í˜„ ìš”êµ¬ì‚¬í•­

```javascript
import StateManager from './state/StateManager.js';
import TreeView from './components/TreeView.js';
import ChatView from './components/ChatView.js';
import Breadcrumbs from './components/Breadcrumbs.js';
import CheckpointList from './components/CheckpointList.js';
import ApiService from './services/ApiService.js';

class App {
    constructor() {
        // ì˜ì¡´ì„± ì£¼ì…
        this.api = new ApiService('http://localhost:8000/api/v1');
        this.state = new StateManager();

        // ì»´í¬ë„ŒíŠ¸ ìƒì„±
        this.treeView = new TreeView(this.state, this.api);
        this.chatView = new ChatView(this.state, this.api);
        this.breadcrumbs = new Breadcrumbs(this.state);
        this.checkpointList = new CheckpointList(this.state, this.api);
    }

    init() {
        // ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸
        this.treeView.mount('#tree-view-container');
        this.chatView.mount('#chat-view-container');
        this.breadcrumbs.mount('#breadcrumbs-container');
        this.checkpointList.mount('#checkpoint-list-container');

        // ì „ì—­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        this.setupEventListeners();

        // ì´ˆê¸° ë°ì´í„° ë¡œë“œ
        this.loadInitialData();
    }

    setupEventListeners() {
        document.getElementById('new-conversation-btn').addEventListener('click', () => {
            this.createNewConversation();
        });

        document.getElementById('save-checkpoint-btn').addEventListener('click', () => {
            this.saveCheckpoint();
        });
    }

    async loadInitialData() {
        // ê¸°ì¡´ ëŒ€í™” ëª©ë¡ ë¡œë“œ ë˜ëŠ” ìƒˆ ëŒ€í™” ìƒì„±
        try {
            const conversations = await this.api.getConversations();
            if (conversations.length > 0) {
                await this.loadConversation(conversations[0].id);
            } else {
                await this.createNewConversation();
            }
        } catch (error) {
            console.error('ì´ˆê¸° ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
        }
    }

    async loadConversation(conversationId) {
        // ëŒ€í™” ë° ë…¸ë“œ ë¡œë“œ
        const conversation = await this.api.getConversation(conversationId);
        const nodes = await this.api.getNodes(conversationId);

        // ìƒíƒœ ì—…ë°ì´íŠ¸
        this.state.setState({
            conversationId,
            nodes,
            activePathIds: conversation.activePathIds || [conversation.rootId],
            selectedNodeId: conversation.rootId
        });
    }

    async createNewConversation() {
        const conversation = await this.api.createConversation({
            title: 'ìƒˆ ëŒ€í™”',
            domain: 'general'
        });
        await this.loadConversation(conversation.id);
    }

    async saveCheckpoint() {
        const { conversationId, activePathIds } = this.state.getState();
        await this.api.createCheckpoint(conversationId, {
            activePathIds,
            reason: 'user_manual'
        });
        alert('ì²´í¬í¬ì¸íŠ¸ ì €ì¥ ì™„ë£Œ');
    }
}

// ì•± ì‹œì‘
document.addEventListener('DOMContentLoaded', () => {
    const app = new App();
    app.init();
});
```

#### ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] StateManager, ì»´í¬ë„ŒíŠ¸, ApiService ì„í¬íŠ¸
- [ ] ì•± í´ë˜ìŠ¤ ì •ì˜ ë° ì´ˆê¸°í™”
- [ ] ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸
- [ ] ì „ì—­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
- [ ] ì´ˆê¸° ë°ì´í„° ë¡œë“œ
- [ ] DOMContentLoaded ì´ë²¤íŠ¸ ì²˜ë¦¬

---

### 3.3 js/state/StateManager.js (ì „ì—­ ìƒíƒœ)

#### ëª©ì 
ì•±ì˜ ì „ì—­ ìƒíƒœ ê´€ë¦¬, ì˜µì €ë²„ íŒ¨í„´ìœ¼ë¡œ ìƒíƒœ ë³€ê²½ ì•Œë¦¼

#### í¬ê¸° ì œí•œ
ìµœëŒ€ 300ì¤„

#### ìƒíƒœ êµ¬ì¡°

```javascript
state = {
    conversationId: 'conv-001',
    nodes: [
        {
            id: 'A',
            parentId: null,
            role: 'system',
            content: '...',
            depth: 0
        },
        // ...
    ],
    activePathIds: ['A', 'B', 'D'],  // í˜„ì¬ í™œì„± ê²½ë¡œ
    selectedNodeId: 'D',              // í˜„ì¬ ì„ íƒ ë…¸ë“œ
    checkpoints: [
        {
            id: 'ckpt-001',
            activePathIds: ['A', 'B'],
            createdAt: '2025-11-05T10:00:00Z',
            reason: 'before_switch'
        },
        // ...
    ],
    shelves: [],                      // ë³´ì¡´ ì˜ì—­
    uiFlags: {
        loading: false,
        warning: false,
        merging: false
    }
};
```

#### êµ¬í˜„ ìš”êµ¬ì‚¬í•­

```javascript
export default class StateManager {
    constructor() {
        this.state = {
            conversationId: null,
            nodes: [],
            activePathIds: [],
            selectedNodeId: null,
            checkpoints: [],
            shelves: [],
            uiFlags: {
                loading: false,
                warning: false,
                merging: false
            }
        };
        this.listeners = [];
    }

    /**
     * ìƒíƒœ ë³€ê²½ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
     * @param {Function} listener - ìƒíƒœ ë³€ê²½ ì‹œ í˜¸ì¶œë  í•¨ìˆ˜
     * @returns {Function} - êµ¬ë… ì·¨ì†Œ í•¨ìˆ˜
     */
    subscribe(listener) {
        this.listeners.push(listener);
        return () => {
            this.listeners = this.listeners.filter(l => l !== listener);
        };
    }

    /**
     * ìƒíƒœ ì—…ë°ì´íŠ¸ (ë¶ˆë³€ì„± ìœ ì§€)
     * @param {Object} newState - ì—…ë°ì´íŠ¸í•  ìƒíƒœ
     */
    setState(newState) {
        this.state = { ...this.state, ...newState };
        this.notifyListeners();
    }

    /**
     * í˜„ì¬ ìƒíƒœ ì¡°íšŒ (ë¶ˆë³€ì„± ìœ ì§€)
     * @returns {Object} - í˜„ì¬ ìƒíƒœ ë³µì‚¬ë³¸
     */
    getState() {
        return { ...this.state };
    }

    /**
     * ë¦¬ìŠ¤ë„ˆì—ê²Œ ìƒíƒœ ë³€ê²½ ì•Œë¦¼
     */
    notifyListeners() {
        this.listeners.forEach(listener => listener(this.state));
    }

    // í¸ì˜ ë©”ì„œë“œë“¤

    /**
     * ë…¸ë“œ IDë¡œ ë…¸ë“œ ì¡°íšŒ
     * @param {string} nodeId
     * @returns {Object|null}
     */
    getNodeById(nodeId) {
        return this.state.nodes.find(n => n.id === nodeId) || null;
    }

    /**
     * í™œì„± ê²½ë¡œì˜ ë…¸ë“œë“¤ ì¡°íšŒ
     * @returns {Array<Object>}
     */
    getActivePathNodes() {
        return this.state.activePathIds.map(id => this.getNodeById(id));
    }

    /**
     * íŠ¹ì • ë…¸ë“œì˜ ìì‹ ë…¸ë“œë“¤ ì¡°íšŒ
     * @param {string} parentId
     * @returns {Array<Object>}
     */
    getChildren(parentId) {
        return this.state.nodes.filter(n => n.parentId === parentId);
    }

    /**
     * ë¡œë”© ìƒíƒœ ì—…ë°ì´íŠ¸
     * @param {boolean} loading
     */
    setLoading(loading) {
        this.setState({
            uiFlags: { ...this.state.uiFlags, loading }
        });
    }
}
```

#### ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ìƒíƒœ êµ¬ì¡° ì •ì˜
- [ ] subscribe/setState/getState ë©”ì„œë“œ êµ¬í˜„
- [ ] ë¶ˆë³€ì„± ìœ ì§€ (spread ì—°ì‚°ì)
- [ ] í¸ì˜ ë©”ì„œë“œ (getNodeById, getActivePathNodes ë“±)
- [ ] ì˜µì €ë²„ íŒ¨í„´ êµ¬í˜„
- [ ] JSDoc ì£¼ì„ ì‘ì„±

---

### 3.4 js/components/TreeView.js (íŠ¸ë¦¬ ë·°)

#### ëª©ì 
íŠ¸ë¦¬ êµ¬ì¡° ì‹œê°í™”, ë…¸ë“œ í´ë¦­ í•¸ë“¤ë§

#### í¬ê¸° ì œí•œ
ìµœëŒ€ 400ì¤„

#### êµ¬í˜„ ìš”êµ¬ì‚¬í•­

```javascript
export default class TreeView {
    constructor(stateManager, apiService) {
        this.state = stateManager;
        this.api = apiService;
        this.container = null;
        this.unsubscribe = null;
    }

    /**
     * ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸
     * @param {string} selector - DOM ì…€ë ‰í„°
     */
    mount(selector) {
        this.container = document.querySelector(selector);
        if (!this.container) {
            throw new Error(`TreeView: ${selector} ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
        }

        // ìƒíƒœ ë³€ê²½ êµ¬ë…
        this.unsubscribe = this.state.subscribe(() => this.render());

        // ì´ˆê¸° ë Œë”ë§
        this.render();
    }

    /**
     * ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸
     */
    unmount() {
        if (this.unsubscribe) {
            this.unsubscribe();
        }
        if (this.container) {
            this.container.innerHTML = '';
        }
    }

    /**
     * íŠ¸ë¦¬ ë Œë”ë§ (ì¬ê·€)
     */
    render() {
        const { nodes, activePathIds, selectedNodeId } = this.state.getState();

        // ë£¨íŠ¸ ë…¸ë“œ ì°¾ê¸°
        const rootNode = nodes.find(n => n.parentId === null);
        if (!rootNode) {
            this.container.innerHTML = '<p>ëŒ€í™” íŠ¸ë¦¬ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.</p>';
            return;
        }

        // íŠ¸ë¦¬ êµ¬ì¡° ìƒì„±
        this.container.innerHTML = '';
        const treeRoot = this.buildTree(rootNode, activePathIds, selectedNodeId);
        this.container.appendChild(treeRoot);
    }

    /**
     * ì¬ê·€ì ìœ¼ë¡œ íŠ¸ë¦¬ ë…¸ë“œ ìƒì„±
     * @param {Object} node - í˜„ì¬ ë…¸ë“œ
     * @param {Array<string>} activePathIds - í™œì„± ê²½ë¡œ
     * @param {string} selectedNodeId - ì„ íƒ ë…¸ë“œ
     * @returns {HTMLElement}
     */
    buildTree(node, activePathIds, selectedNodeId) {
        const nodeElement = document.createElement('div');
        nodeElement.className = 'tree-node';
        nodeElement.dataset.nodeId = node.id;

        // í™œì„± ê²½ë¡œ í•˜ì´ë¼ì´íŠ¸
        if (activePathIds.includes(node.id)) {
            nodeElement.classList.add('active');
        }

        // ì„ íƒ ë…¸ë“œ í•˜ì´ë¼ì´íŠ¸
        if (node.id === selectedNodeId) {
            nodeElement.classList.add('selected');
        }

        // ë…¸ë“œ ë¼ë²¨
        const label = document.createElement('div');
        label.className = 'tree-node-label';
        label.textContent = this.getNodeLabel(node);
        label.addEventListener('click', () => this.handleNodeClick(node.id));
        nodeElement.appendChild(label);

        // ìì‹ ë…¸ë“œë“¤ ì¬ê·€ ë Œë”ë§
        const children = this.state.getChildren(node.id);
        if (children.length > 0) {
            const childrenContainer = document.createElement('div');
            childrenContainer.className = 'tree-node-children';

            children.forEach(child => {
                const childElement = this.buildTree(child, activePathIds, selectedNodeId);
                childrenContainer.appendChild(childElement);
            });

            nodeElement.appendChild(childrenContainer);
        }

        return nodeElement;
    }

    /**
     * ë…¸ë“œ ë¼ë²¨ ìƒì„±
     * @param {Object} node
     * @returns {string}
     */
    getNodeLabel(node) {
        const prefix = node.role === 'user' ? 'ğŸ™‚' : 'ğŸ¤–';
        const preview = node.content.substring(0, 20);
        return `${prefix} ${preview}...`;
    }

    /**
     * ë…¸ë“œ í´ë¦­ í•¸ë“¤ëŸ¬ (ê²½ë¡œ ì „í™˜)
     * @param {string} nodeId
     */
    async handleNodeClick(nodeId) {
        const { conversationId, selectedNodeId } = this.state.getState();

        // ë™ì¼ ë…¸ë“œ í´ë¦­ ì‹œ ë¬´ì‹œ
        if (nodeId === selectedNodeId) {
            return;
        }

        // ë¡œë”© ìƒíƒœ
        this.state.setLoading(true);

        try {
            // ê²½ë¡œ ì „í™˜ API í˜¸ì¶œ
            const result = await this.api.switchPath(conversationId, {
                currentLeafId: selectedNodeId,
                targetNodeId: nodeId
            });

            // ìƒíƒœ ì—…ë°ì´íŠ¸
            this.state.setState({
                activePathIds: result.activePathIds,
                selectedNodeId: nodeId
            });

        } catch (error) {
            console.error('ê²½ë¡œ ì „í™˜ ì‹¤íŒ¨:', error);
            alert('ê²½ë¡œ ì „í™˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        } finally {
            this.state.setLoading(false);
        }
    }
}
```

#### CSS ìš”êµ¬ì‚¬í•­ (tree-view.css)

```css
.tree-node {
    margin-left: 20px;
    padding: 5px 0;
}

.tree-node-label {
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    cursor: pointer;
    display: inline-block;
    background: #fff;
}

.tree-node-label:hover {
    background: #f0f0f0;
}

.tree-node.active > .tree-node-label {
    border-color: #007bff;
    background: #e7f3ff;
}

.tree-node.selected > .tree-node-label {
    border-color: #28a745;
    background: #d4edda;
    font-weight: bold;
}

.tree-node-children {
    margin-top: 5px;
}
```

#### ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] íŠ¸ë¦¬ ì¬ê·€ ë Œë”ë§
- [ ] í™œì„± ê²½ë¡œ í•˜ì´ë¼ì´íŠ¸
- [ ] ì„ íƒ ë…¸ë“œ í•˜ì´ë¼ì´íŠ¸
- [ ] ë…¸ë“œ í´ë¦­ â†’ ê²½ë¡œ ì „í™˜ API í˜¸ì¶œ
- [ ] ìƒíƒœ êµ¬ë… ë° ìë™ ë Œë”ë§
- [ ] ë¡œë”© ìƒíƒœ ì²˜ë¦¬
- [ ] ì—ëŸ¬ í•¸ë“¤ë§

---

### 3.5 js/components/ChatView.js (ëŒ€í™” íŒ¨ë„)

#### ëª©ì 
í™œì„± ê²½ë¡œì˜ ëŒ€í™” ë©”ì‹œì§€ í‘œì‹œ, ìƒˆ ë©”ì‹œì§€ ì…ë ¥

#### í¬ê¸° ì œí•œ
ìµœëŒ€ 300ì¤„

#### êµ¬í˜„ ìš”êµ¬ì‚¬í•­

```javascript
export default class ChatView {
    constructor(stateManager, apiService) {
        this.state = stateManager;
        this.api = apiService;
        this.container = null;
        this.unsubscribe = null;
    }

    mount(selector) {
        this.container = document.querySelector(selector);
        if (!this.container) {
            throw new Error(`ChatView: ${selector} ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
        }

        // ì…ë ¥ í¼ ìƒì„±
        this.createInputForm();

        // ìƒíƒœ ë³€ê²½ êµ¬ë…
        this.unsubscribe = this.state.subscribe(() => this.render());

        // ì´ˆê¸° ë Œë”ë§
        this.render();
    }

    unmount() {
        if (this.unsubscribe) {
            this.unsubscribe();
        }
    }

    render() {
        const { activePathIds } = this.state.getState();
        const messages = activePathIds.map(id => this.state.getNodeById(id));

        // ë©”ì‹œì§€ ì»¨í…Œì´ë„ˆ
        let messagesContainer = this.container.querySelector('.messages-container');
        if (!messagesContainer) {
            messagesContainer = document.createElement('div');
            messagesContainer.className = 'messages-container';
            this.container.prepend(messagesContainer);
        }

        // ë©”ì‹œì§€ ë Œë”ë§
        messagesContainer.innerHTML = '';
        messages.forEach(msg => {
            if (msg) {
                const messageElement = this.createMessageElement(msg);
                messagesContainer.appendChild(messageElement);
            }
        });

        // ìŠ¤í¬ë¡¤ í•˜ë‹¨ìœ¼ë¡œ
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    createMessageElement(message) {
        const div = document.createElement('div');
        div.className = `message message-${message.role}`;

        const role = document.createElement('div');
        role.className = 'message-role';
        role.textContent = message.role === 'user' ? 'ì‚¬ìš©ì' : 'AI';

        const content = document.createElement('div');
        content.className = 'message-content';
        content.textContent = message.content;

        div.appendChild(role);
        div.appendChild(content);
        return div;
    }

    createInputForm() {
        const form = document.createElement('form');
        form.className = 'chat-input-form';

        const textarea = document.createElement('textarea');
        textarea.className = 'chat-input';
        textarea.placeholder = 'ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...';
        textarea.rows = 3;

        const button = document.createElement('button');
        button.type = 'submit';
        button.textContent = 'ì „ì†¡';

        form.appendChild(textarea);
        form.appendChild(button);

        form.addEventListener('submit', (e) => this.handleSubmit(e));

        this.container.appendChild(form);
    }

    async handleSubmit(event) {
        event.preventDefault();

        const textarea = this.container.querySelector('.chat-input');
        const userMessage = textarea.value.trim();

        if (!userMessage) {
            return;
        }

        // ì…ë ¥ ì´ˆê¸°í™”
        textarea.value = '';

        // ë¡œë”© ìƒíƒœ
        this.state.setLoading(true);

        try {
            const { conversationId, selectedNodeId } = this.state.getState();

            // ì‚¬ìš©ì ë©”ì‹œì§€ ë…¸ë“œ ìƒì„±
            const userNode = await this.api.createNode(conversationId, {
                parentId: selectedNodeId,
                role: 'user',
                content: userMessage
            });

            // AI ì‘ë‹µ ìƒì„±
            const aiResponse = await this.api.generateAI(conversationId, {
                contextBlockIds: [...this.state.getState().activePathIds, userNode.id],
                prompt: userMessage
            });

            // AI ë©”ì‹œì§€ ë…¸ë“œ ìƒì„±
            const aiNode = await this.api.createNode(conversationId, {
                parentId: userNode.id,
                role: 'assistant',
                content: aiResponse.content
            });

            // ë…¸ë“œ ëª©ë¡ ê°±ì‹ 
            const nodes = await this.api.getNodes(conversationId);
            this.state.setState({
                nodes,
                activePathIds: [...this.state.getState().activePathIds, userNode.id, aiNode.id],
                selectedNodeId: aiNode.id
            });

        } catch (error) {
            console.error('ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨:', error);
            alert('ë©”ì‹œì§€ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        } finally {
            this.state.setLoading(false);
        }
    }
}
```

#### CSS ìš”êµ¬ì‚¬í•­ (chat-view.css)

```css
.messages-container {
    max-height: 500px;
    overflow-y: auto;
    padding: 20px;
    border: 1px solid #ddd;
    border-radius: 4px;
    margin-bottom: 20px;
}

.message {
    margin-bottom: 15px;
    padding: 10px;
    border-radius: 4px;
}

.message-user {
    background: #e7f3ff;
    text-align: right;
}

.message-assistant {
    background: #f0f0f0;
    text-align: left;
}

.message-role {
    font-weight: bold;
    font-size: 0.9em;
    margin-bottom: 5px;
}

.message-content {
    font-size: 1em;
}

.chat-input-form {
    display: flex;
    gap: 10px;
}

.chat-input {
    flex: 1;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    resize: vertical;
}

.chat-input-form button {
    padding: 10px 20px;
    background: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.chat-input-form button:hover {
    background: #0056b3;
}
```

#### ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] í™œì„± ê²½ë¡œ ë©”ì‹œì§€ í‘œì‹œ
- [ ] ì…ë ¥ í¼ ìƒì„±
- [ ] ë©”ì‹œì§€ ì „ì†¡ â†’ ë…¸ë“œ ìƒì„± â†’ AI ì‘ë‹µ
- [ ] ìŠ¤í¬ë¡¤ ìë™ í•˜ë‹¨ ì´ë™
- [ ] ë¡œë”© ìƒíƒœ ì²˜ë¦¬
- [ ] ì—ëŸ¬ í•¸ë“¤ë§

---

### 3.6 js/components/Breadcrumbs.js (ê²½ë¡œ í‘œì‹œ)

#### ëª©ì 
í˜„ì¬ í™œì„± ê²½ë¡œë¥¼ ë¸Œë ˆë“œí¬ëŸ¼ í˜•íƒœë¡œ í‘œì‹œ

#### í¬ê¸° ì œí•œ
ìµœëŒ€ 150ì¤„

#### êµ¬í˜„ ìš”êµ¬ì‚¬í•­

```javascript
export default class Breadcrumbs {
    constructor(stateManager) {
        this.state = stateManager;
        this.container = null;
        this.unsubscribe = null;
    }

    mount(selector) {
        this.container = document.querySelector(selector);
        this.unsubscribe = this.state.subscribe(() => this.render());
        this.render();
    }

    unmount() {
        if (this.unsubscribe) {
            this.unsubscribe();
        }
    }

    render() {
        const { activePathIds } = this.state.getState();

        this.container.innerHTML = '';

        const breadcrumb = document.createElement('div');
        breadcrumb.className = 'breadcrumbs';

        activePathIds.forEach((nodeId, index) => {
            const node = this.state.getNodeById(nodeId);
            if (!node) return;

            const item = document.createElement('span');
            item.className = 'breadcrumb-item';
            item.textContent = this.getNodeLabel(node);

            breadcrumb.appendChild(item);

            if (index < activePathIds.length - 1) {
                const separator = document.createElement('span');
                separator.className = 'breadcrumb-separator';
                separator.textContent = ' / ';
                breadcrumb.appendChild(separator);
            }
        });

        this.container.appendChild(breadcrumb);
    }

    getNodeLabel(node) {
        return node.id;  // ë˜ëŠ” ë‹¤ë¥¸ í‘œì‹œ ë°©ì‹
    }
}
```

#### ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] í™œì„± ê²½ë¡œ í‘œì‹œ
- [ ] êµ¬ë¶„ì (/) í‘œì‹œ
- [ ] ìë™ ë Œë”ë§

---

### 3.7 js/services/ApiService.js (API í˜¸ì¶œ)

#### ëª©ì 
ë°±ì—”ë“œ API í˜¸ì¶œ ì¶”ìƒí™”

#### í¬ê¸° ì œí•œ
ìµœëŒ€ 400ì¤„

#### êµ¬í˜„ ìš”êµ¬ì‚¬í•­

```javascript
export default class ApiService {
    constructor(baseURL) {
        this.baseURL = baseURL;
    }

    async request(endpoint, options = {}) {
        const url = `${this.baseURL}${endpoint}`;
        const config = {
            headers: {
                'Content-Type': 'application/json',
                ...options.headers
            },
            ...options
        };

        try {
            const response = await fetch(url, config);

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.detail || 'API ìš”ì²­ ì‹¤íŒ¨');
            }

            return await response.json();
        } catch (error) {
            console.error('API ìš”ì²­ ì˜¤ë¥˜:', error);
            throw error;
        }
    }

    // ëŒ€í™” ê´€ë¦¬
    async getConversations() {
        return this.request('/conversations');
    }

    async getConversation(conversationId) {
        return this.request(`/conversations/${conversationId}`);
    }

    async createConversation(data) {
        return this.request('/conversations', {
            method: 'POST',
            body: JSON.stringify(data)
        });
    }

    // ë…¸ë“œ ê´€ë¦¬
    async getNodes(conversationId) {
        return this.request(`/conversations/${conversationId}/nodes`);
    }

    async createNode(conversationId, data) {
        return this.request(`/conversations/${conversationId}/nodes`, {
            method: 'POST',
            body: JSON.stringify(data)
        });
    }

    // ê²½ë¡œ ì „í™˜
    async switchPath(conversationId, data) {
        return this.request(`/conversations/${conversationId}/switch`, {
            method: 'POST',
            body: JSON.stringify(data)
        });
    }

    // ì²´í¬í¬ì¸íŠ¸
    async getCheckpoints(conversationId) {
        return this.request(`/conversations/${conversationId}/checkpoints`);
    }

    async createCheckpoint(conversationId, data) {
        return this.request(`/conversations/${conversationId}/checkpoints`, {
            method: 'POST',
            body: JSON.stringify(data)
        });
    }

    async restoreCheckpoint(conversationId, checkpointId) {
        return this.request(`/conversations/${conversationId}/restore`, {
            method: 'POST',
            body: JSON.stringify({ checkpointId })
        });
    }

    // AI ì‘ë‹µ
    async generateAI(conversationId, data) {
        return this.request('/ai/generate', {
            method: 'POST',
            body: JSON.stringify({
                conversationId,
                ...data
            })
        });
    }
}
```

#### ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] fetch ë˜í¼ êµ¬í˜„
- [ ] ì—ëŸ¬ í•¸ë“¤ë§
- [ ] JSON ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
- [ ] ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ ë©”ì„œë“œ êµ¬í˜„

---

## 4. CSS ë ˆì´ì•„ì›ƒ ê°€ì´ë“œ

### 4.1 layout.css

```css
.app-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
}

.app-header {
    padding: 20px;
    background: #333;
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.app-main {
    flex: 1;
    display: flex;
    overflow: hidden;
}

.sidebar {
    width: 300px;
    padding: 20px;
    overflow-y: auto;
    border-right: 1px solid #ddd;
}

.sidebar-right {
    border-right: none;
    border-left: 1px solid #ddd;
}

.main-content {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
}
```

---

## 5. ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì „ì²´ êµ¬ì¡°
- [ ] index.html ì‘ì„±
- [ ] CSS íŒŒì¼ ì‘ì„± (reset, layout, components)
- [ ] ëª¨ë“ˆ ì‹œìŠ¤í…œ ì„¤ì • (ES6 import/export)

### í•µì‹¬ íŒŒì¼
- [ ] main.js: ì•± ì´ˆê¸°í™”
- [ ] StateManager.js: ìƒíƒœ ê´€ë¦¬
- [ ] ApiService.js: API í˜¸ì¶œ

### ì»´í¬ë„ŒíŠ¸
- [ ] TreeView.js: íŠ¸ë¦¬ ë Œë”ë§, ë…¸ë“œ í´ë¦­
- [ ] ChatView.js: ëŒ€í™” í‘œì‹œ, ë©”ì‹œì§€ ì…ë ¥
- [ ] Breadcrumbs.js: ê²½ë¡œ í‘œì‹œ
- [ ] CheckpointList.js: ì²´í¬í¬ì¸íŠ¸ ëª©ë¡

### ê¸°ëŠ¥
- [ ] ê²½ë¡œ ì „í™˜ (ë…¸ë“œ í´ë¦­ â†’ API í˜¸ì¶œ â†’ ìƒíƒœ ì—…ë°ì´íŠ¸)
- [ ] ë©”ì‹œì§€ ì „ì†¡ (ì…ë ¥ â†’ ë…¸ë“œ ìƒì„± â†’ AI ì‘ë‹µ)
- [ ] ì²´í¬í¬ì¸íŠ¸ ì €ì¥/ë³µì›
- [ ] ë¡œë”© ìƒíƒœ ì²˜ë¦¬
- [ ] ì—ëŸ¬ í•¸ë“¤ë§

### í…ŒìŠ¤íŠ¸
- [ ] ìˆ˜ë™ í…ŒìŠ¤íŠ¸: ê° ê¸°ëŠ¥ ë™ì‘ í™•ì¸
- [ ] ë¸Œë¼ìš°ì € í˜¸í™˜ì„± (Chrome, Firefox, Safari)
- [ ] ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ í™•ì¸

---

## 6. ê°œë°œ ì‹œ ì£¼ì˜ì‚¬í•­

### íŒŒì¼ í¬ê¸°
- ê° íŒŒì¼ì€ **ìµœëŒ€ 1,000ì¤„, ì´ìƒì  200ì¤„**
- ì´ˆê³¼ ì‹œ íŒŒì¼ ë¶„ë¦¬ (ì˜ˆ: TreeView â†’ TreeView + TreeRenderer)

### ì½”ë“œ ìŠ¤íƒ€ì¼
- ES6+ ë¬¸ë²• ì‚¬ìš©
- const/letë§Œ ì‚¬ìš©, var ê¸ˆì§€
- í™”ì‚´í‘œ í•¨ìˆ˜ ìš°ì„ 
- JSDoc ì£¼ì„ ì‘ì„±

### ì„±ëŠ¥
- ë¶ˆí•„ìš”í•œ ë Œë”ë§ ë°©ì§€
- í° ëª©ë¡ì€ ê°€ìƒ ìŠ¤í¬ë¡¤ ê³ ë ¤
- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì •ë¦¬ (ì–¸ë§ˆìš´íŠ¸ ì‹œ)

### ë³´ì•ˆ
- XSS ë°©ì§€: textContent ì‚¬ìš©, innerHTML ì‹ ì¤‘íˆ
- API í‚¤ ë…¸ì¶œ ê¸ˆì§€ (ë°±ì—”ë“œì—ì„œ ì²˜ë¦¬)

---

## 7. ë‹¤ìŒ ë‹¨ê³„

1. **íŒŒì¼ ìƒì„±**: ë””ë ‰í† ë¦¬ êµ¬ì¡° ë° íŒŒì¼ ìƒì„±
2. **í•µì‹¬ êµ¬í˜„**: StateManager, ApiService, main.js
3. **ì»´í¬ë„ŒíŠ¸ êµ¬í˜„**: TreeView, ChatView ìˆœì„œ
4. **í†µí•© í…ŒìŠ¤íŠ¸**: ë°±ì—”ë“œ APIì™€ ì—°ë™ í…ŒìŠ¤íŠ¸
5. **UI ê°œì„ **: CSS ìŠ¤íƒ€ì¼ë§, ì• ë‹ˆë©”ì´ì…˜

---

## 8. ì§ˆë¬¸ ë° ì§€ì›

êµ¬í˜„ ì¤‘ ë¶ˆëª…í™•í•œ ì‚¬í•­ì´ ìˆìœ¼ë©´ ì•„í‚¤í…ì²˜ ì„¤ê³„ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.

- íŒŒì¼ êµ¬ì¡° ê´€ë ¨
- API ê³„ì•½ ë¶ˆì¼ì¹˜
- ì„±ëŠ¥ ë¬¸ì œ
- ì„¤ê³„ ì˜ë„ í™•ì¸

**ê°œë°œ ì™„ë£Œ í›„ ì½”ë“œ ë¦¬ë·°ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.**
