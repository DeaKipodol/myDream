# 아키텍처 설계자 질의서

**작성일**: 2025-11-05
**작성자**: 초기 개발 기술 총괄자
**수신**: 아키텍처 설계자

---

## 1. 파일구조_설계서.md 검토 완료

설계서를 꼼꼼히 읽었습니다. 매우 상세하고 명확하게 작성되어 있어 큰 도움이 됩니다.

---

## 2. 프로토타입 단계 파일 구조 관련 질문

### 질문 1: 프로토타입 폴더 위치

**현재 상황**:
- 저는 `/myDream/prototype/` 폴더를 임시로 만들었습니다
- 설계서는 `/myDream/frontend/`, `/myDream/backend/`를 정의하고 있습니다

**질문**:
프로토타입 단계에서 어떤 구조를 사용해야 하나요?

**옵션 A**: 설계서 구조를 바로 따라감
```
myDream/
├── frontend/
│   ├── index.html
│   ├── css/
│   ├── js/
│   │   ├── main.js
│   │   ├── state/
│   │   ├── components/
│   │   └── services/
│   └── assets/
├── backend/
│   ├── main.py
│   ├── config/
│   ├── api/
│   └── domain/
```

**옵션 B**: 프로토타입 전용 폴더 사용 (나중에 이동)
```
myDream/
├── prototype/
│   ├── frontend/
│   │   └── index.html (단순 구조)
│   └── backend/
│       └── main.py (단순 구조)
├── frontend/  (나중에 여기로 이동)
└── backend/   (나중에 여기로 이동)
```

**제 생각**:
- 옵션 A가 좋을 것 같습니다 (나중에 이동할 필요 없음)
- 단, 프로토타입 단계에서는 설계서의 모든 파일을 만들지 않고, 필요한 것만 점진적으로 추가

**어떤 방식을 추천하시나요?**

---

### 질문 2: 프론트엔드 기술 스택

**설계서 내용**:
- HTML/CSS/JavaScript (Vanilla JS)
- StateManager.js (옵저버 패턴)

**질문**:
1. Vanilla JS를 고집해야 하나요? 아니면 React/Vue 사용 가능한가요?
2. 만약 Vanilla JS로 시작한다면, 언제 React/Vue로 전환하나요?

**제 경험**:
- Vanilla JS: 프로토타입 빠름, 하지만 복잡해지면 관리 어려움
- React: 초기 설정 시간 필요, 하지만 확장성 좋음

**제안**:
- **프로토타입**: Vanilla JS (빠른 검증)
- **역할 분리 후**: React/Vue로 전환 (프론트엔드 전담자 배정 시)

**동의하시나요?**

---

### 질문 3: 파일 크기 규칙 준수 시점

**설계서 규칙**:
- 최대 1,000줄
- 이상적 200줄
- 800줄 이상 시 분리 고려

**질문**:
프로토타입 단계에서도 이 규칙을 엄격히 지켜야 하나요?

**제 생각**:
- **프로토타입 단계**: 약간 느슨하게 (빠른 개발 우선)
  - 예: TreeView.js가 500줄이 되어도 일단 진행
- **역할 분리 후**: 엄격히 준수
  - 프론트엔드 담당자가 리팩토링하면서 분리

**동의하시나요? 아니면 처음부터 엄격히 지켜야 하나요?**

---

### 질문 4: 백엔드 데이터 저장 방식

**설계서 내용**:
- MongoDB (문서 지향 저장소)
- 컬렉션: conversations, nodes, checkpoints, shelves, sessions, users

**질문**:
프로토타입 단계에서 MongoDB를 바로 사용해야 하나요?

**옵션 A**: 메모리 내 데이터 구조
```python
# 전역 딕셔너리
nodes = {}
conversations = {}
```
- 장점: 설치 불필요, 빠른 시작
- 단점: 재시작 시 데이터 손실

**옵션 B**: JSON 파일
```python
import json
with open('data/nodes.json', 'r') as f:
    nodes = json.load(f)
```
- 장점: 데이터 보존, 간단
- 단점: 동시성 처리 어려움

**옵션 C**: SQLite
- 장점: 실제 DB와 유사, 설치 간단
- 단점: NoSQL과 다름

**옵션 D**: MongoDB (바로 시작)
- 장점: 최종 구조와 동일
- 단점: 초기 설정 시간

**제 추천**:
- **프로토타입**: 옵션 A (메모리)
- **API 통합 단계**: 옵션 B (JSON 파일)
- **역할 분리 후**: 옵션 D (MongoDB)

**어떤 방식을 추천하시나요?**

---

## 3. 인터페이스 계약 관련 질문

### 질문 5: API 스키마 정의 시점

**설계서에는 OpenAPI 스펙 파일이 언급되어 있습니다**:
- `docs/api/openapi.yaml`

**질문**:
1. 프로토타입 단계에서 OpenAPI 스펙을 작성해야 하나요?
2. 아니면 개발하면서 나중에 추가하나요?

**제 생각**:
- **프로토타입**: 간단한 주석으로 API 명세
- **역할 분리 전**: OpenAPI 스펙 작성 (프론트/백엔드 담당자 분리 시점)

**동의하시나요?**

---

### 질문 6: 프론트-백 인터페이스 예시

설계서의 예시 코드는 매우 도움이 됩니다. 하지만 실제 요청/응답 예시가 있으면 더 좋을 것 같습니다.

**요청**:
다음 API의 요청/응답 예시를 제공해주실 수 있나요?

1. **POST /conversations/{id}/switch** (경로 전환)
   ```json
   // 요청
   {
     "currentLeafId": "D",
     "targetNodeId": "F",
     "clientVersion": 1
   }

   // 응답
   {
     "activePathIds": ["A", "B", "F"],
     "lcaNodeId": "B",
     "checkpointBeforeId": "ckpt_123",
     "checkpointAfterId": "ckpt_124",
     "shelvesDelta": [...]
   }
   ```

2. **GET /conversations/{id}/nodes/{nodeId}/path** (경로 조회)

이런 예시가 있으면 개발하면서 참고하기 좋을 것 같습니다.

---

## 4. 알고리즘 구현 관련 질문

### 질문 7: LCA 알고리즘 우선순위

**설계서 내용**:
- 소규모: 선형 방식 (lca_linear.py)
- 대규모: Binary Lifting (lca_binary_lifting.py)
- 임계값으로 자동 선택

**질문**:
프로토타입 단계에서 어떤 순서로 구현하나요?

**옵션 A**: 선형만 구현
- 프로토타입에는 충분
- Binary Lifting은 나중에

**옵션 B**: 둘 다 구현
- 처음부터 완벽하게

**제 추천**: 옵션 A (선형만)

**동의하시나요?**

---

### 질문 8: 체크포인트 구현 시점

**설계서 내용**:
- 체크포인트: 경로 전환 전/후 자동 생성
- 복원 기능

**질문**:
체크포인트를 프로토타입에 포함해야 하나요?

**제 생각**:
- **프로토타입 초기**: 체크포인트 없음 (경로 전환만)
- **프로토타입 후반**: 체크포인트 추가

**어떻게 생각하시나요?**

---

## 5. 역할 분리 계획

### 질문 9: 역할 분리 시점

**질문**:
언제 프론트/백엔드 담당자를 분리하는 것이 좋을까요?

**옵션 A**: 프로토타입 완성 후
- 장점: 전체 구조 파악 후 분리
- 단점: 시간 소요

**옵션 B**: 프론트 프로토타입 완성 후 바로
- 장점: 빠른 병렬 작업
- 단점: 인터페이스 변경 시 혼란

**제 생각**: 옵션 A (프로토타입 완성 후)

**어떻게 생각하시나요?**

---

## 6. 요청 사항

**아키텍처 설계자님께 요청**:
1. 위 질문들에 대한 답변
2. API 요청/응답 예시 제공 (가능하면)
3. 프로토타입 단계에서 특별히 주의해야 할 사항

**확인 후**:
- 파일 구조 확정
- 개발 시작
- 개발 경험 기록 (역할 분리 제안용)

---

**다음 액션**:
- PM 우선순위 확인 대기
- 아키텍처 설계자 답변 대기
- 답변 받으면 즉시 개발 시작

감사합니다!
